

```{r setup, include=FALSE}

solve_assignment <- function(cost_matrix) {
  n <- nrow(cost_matrix)
  assigned_rows <- rep(FALSE, n)
  assigned_cols <- rep(FALSE, n)
  assignments <- numeric(n)
  
  for (i in 1:n) {
    min_cost <- Inf
    min_col <- NA
    
    for (j in 1:n) {
      if (!assigned_cols[j] && cost_matrix[i, j] < min_cost) {
        min_cost <- cost_matrix[i, j]
        min_col <- j
      }
    }
    
    assignments[i] <- min_col
    assigned_rows[i] <- TRUE
    assigned_cols[min_col] <- TRUE
  }
  
  return(assignments)
}

# Exemple d'utilisation
cost_matrix <- matrix(c(10, 2, 3, 4,
                        5, 8, 7, 6,
                        8, 7, 6, 5,
                        3, 6, 7, 8), nrow = 4, byrow = TRUE)

assignments <- solve_assignment(cost_matrix)
print(assignments)

```

```{r cleaning, include=FALSE}

data <- read.csv("donnÃ©es_centroides_classe-cluster_MNIST.csv")
subdata<-data[, -(1:2)]

cost_matrix <- matrix(0, nrow = 10, ncol = 10)

for (i in 1: 10) {
  for (j in 11: 20) {
    cost_matrix[i,j-10]=sum((subdata[i,] - subdata[j,])^2)
  }
}

```


```{r}

times <- list() 
n_times <- 0

for (n in seq(from = 10, to = 4000, by = 500)) {
  cost_matrix <- pnorm(matrix(rnorm(n * n), nrow = n, ncol = n))
  timing <- system.time(total_cost <- solve_assignment(cost_matrix))
  n_times <- n_times + 1
  times[[n_times]] <- timing["elapsed"]  
}

```

```{r}

library(ggplot2)

ca_times <- c(0,0.04,0.16,0.25,0.5,0.69,1,1.31)

x <- c(10,510,1010,1510,2010,2510,3010,3510)

data <- data.frame(x = x, y = ca_times)

ggplot(data, aes(x = x, y = y)) +
  geom_point() + 
  labs(x = "nb de clusters/classe", y = "temps", title = "")
```